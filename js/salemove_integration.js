!function(){function n(n,t,e){sm.getApi({version:"v1"}).then((function(){sm.logger[n](t,e)}))}function t(){var t=f.match(/__sm[\._]accessToken=([^&#]+)/);if(t)return n("info","Found access token in the page query string"),t[1]}function e(){var t=localStorage.getItem("sm.access_token");if(t)return n("info","Found access token from the local storage"),t}function r(){var t=f.match(/__sm[\._]consolidation=([^&#]+)/);if(t)return n("info","Found consolidation token in the page query string"),t[1]}function o(n){return n&&"string"==typeof n}function i(n){return[o(n.sessionId)?function(n){return"external_session_id="+n}(n.sessionId):"",o(n.idToken)?function(n){return"id_token="+n}(n.idToken):"",o(n.accessToken)?function(n){return"external_access_token="+n}(n.accessToken):""]}function s(t){return new Promise((function(e){t.then((function(n){e(i(n))})).catch((function(t){n("warn","Failed to resolve getGliaContext promise",{error:t}),e([])}))}))}if(!window.sm){var a=document.currentScript||document.querySelector('script[src*="salemove_integration.js"]');if(!a)return void console.error("Unable to find the salemove_integration.js script on the page.");window.sm={loadDynamic:!0},sm._apiHandlers=[],sm.getApi=function(n){return"function"==typeof sm._getApi?sm._getApi(n):new Promise((function(t,e){sm._apiHandlers.push({options:n,resolve:t,reject:e})}))};var c=function(n){if(!n)return!1;var t="sm.test";try{return n.setItem(t,"1"),n.removeItem(t),!0}catch(n){return!1}};if(!(c(window.localStorage)&&c(window.sessionStorage)&&null!=window.location&&window.MutationObserver))return;if(function(){var n=navigator.userAgent;return!n||/(.*https?:\/\/|bot|googlebot|crawler|spider|robot|crawling|dejaclick)/i.test(n)}())return;var u=function(n){var t=n.indexOf("?");return-1!==t?n.substring(t+1):""},f=u(window.location.href);!function(){if(!window||!window.Promise){var n=function(){"use strict";function n(n){var t,e;e=this,b&&(e[i]=g()),n!==r&&((t=h(n)(m(e,a),m(e,s),e))===f&&R(e,s,t.e))}var t,e,r,o,i,s,a,c,u,f,l,d,p,_,m,v,g,h,w,y,x,k,b,C,j,T,S,I,R,A,F,U;return e=void 0,T="object"==typeof global?global:window,n.prototype.then=function(n,t){return l(this,j(),n,t)},n.prototype.catch=function(n){return this.then(e,n)},n.resolve=function(t){return t instanceof n?t:A(j(),t)},n.reject=function(n){return R(j(),s,n)},n.race=function(t){var e,r,i;if(d(t),0===(r=t.length))return n.resolve([]);for(i=j(),e=0;r>e&&(A(i,t[e++]),i._state===o););return i},n.all=function(t){var e,r,o,i,c,u,f,l;if(d(t),e=n.resolve,0===(c=r=t.length))return e([]);for(f=j(),l=[],o=0,u=function(n){R(f,s,n)},i=function(n){e(t[n]).then((function(t){l[n]=t,--r||R(f,a,l)}),u)};c>o;)i(o++);return f},n.onUnhandledRejection=function(n,t){var e;T.console&&(e=v(n,t),console.error("Unhandled Rejection:",e[0],e[1]))},b=!1,n.enableLongStackTrace=function(){b=!0},n.nextTick=T.process?T.process.nextTick:function(n){return setTimeout(n)},u=null,f={e:null},r={},C=function(n){return"object"==typeof n},k=function(n){return"function"==typeof n},U=function(){var n;try{return u.apply(this,arguments)}catch(t){return n=t,f.e=n,f}},h=function(n){return u=n,U},_=function(t,r){var o,i,s;return i=Array(t),s=0,o=function(){var n;for(n=0;s>n;)r(i[n]),i[n++]=e;s=0,i.length>t&&(i.length=t)},function(t){i[s++]=t,1===s&&n.nextTick(o)}},d=function(n){if(!(n instanceof Array))throw w("invalid_argument")},w=function(n){return new TypeError(n)},g=function(n){return(new Error).stack.replace("Error",n?"":t)},s=0,a=1,o=2,i="_pt",c="_st",t="From previous event:",n.prototype._state=o,n.prototype._pCount=0,n.prototype._pre=null,j=function(){return new n(r)},m=function(n,t){return function(e){b&&(n[c]=g(!0)),t===a?A(n,e):R(n,t,e)}},l=function(n,t,e,r){return k(e)&&(t._onFulfilled=e),k(r)&&(t._onRejected=r),b&&(t._pre=n),n[n._pCount++]=t,n._state!==o&&n._pCount>0&&S(n),t},S=_(999,(function(n){var t,r,i,a,c;for(r=0,i=n._pCount;i>r;)(a=n[r++])._state===o&&((t=n._state?a._onFulfilled:a._onRejected)!==e?(c=h(p)(t,n._value))!==f?A(a,c):R(a,s,c.e):R(a,n._state,n._value))})),x=function(n){var t,e,r;if(n._umark)return!0;for(n._umark=!0,e=0,r=n._pCount;r>e;){if((t=n[e++])._onRejected)return!0;if(x(t))return!0}},I=_(9,_(9,(function(t){x(t)||n.onUnhandledRejection(t._value,t)}))),v=function(n,e){var r,o,s,a,u,f;return a=[],f=function(n){return n.replace(/^\s+|\s+$/g,"")},b&&e[i]&&(s=function(n){return a.push(f(n))},e[c]&&s(e[c]),(o=function(n){return n?(o(n._next),s(n[i]),o(n._pre)):void 0})(e)),u="\n"+a.join("\n"),r=function(n,e){var r;return e&&(r=n.indexOf("\n"+t))>0&&(n=n.slice(0,r)),"string"==typeof __filename?n.replace(RegExp(".+"+__filename+".+\\n?","g"),""):void 0},[n&&n.stack?r(f(n.stack),!0):n,r(u)]},p=function(n,t){return n(t)},R=function(n,t,e){var r;if(n._state===o)return n._state=t,n._value=e,t===s&&(b&&e&&e.stack&&(r=v(e,n),e.stack=r[0]+r[1]),I(n)),n._pCount>0&&S(n),n},A=function(t,e){var r;if(e!==t||!e){if(null!==e&&(k(e)||C(e))){if((r=h(y)(e))===f)return void R(t,s,r.e);k(r)?(b&&e instanceof n&&(t._next=e),F(t,e,r)):R(t,a,e)}else R(t,a,e);return t}R(t,s,w("promise_circular_chain"))},y=function(n){return n.then},F=function(n,t,e){var r;(r=h(e).call(t,(function(e){t&&(t=null,A(n,e))}),(function(e){t&&(t=null,R(n,s,e))})))===f&&t&&(R(n,s,r.e),t=null)},n}();window.Promise=n}}();var l=function(){var n=u(a.src);return""===n?{}:n.split("&").reduce((function(n,t){var e=t.split("=");return n[e[0]]=e[1],n}),{})}();if(l.session_context){n("info","Found session context in integration script query string");var d=l.session_context;try{var p=atob(decodeURIComponent(d));sm._sessionContext=JSON.parse(p)}catch(t){n("warn","Could not parse session context",{session_context:d})}}var _=["referrer="+encodeURIComponent(location.origin+location.pathname),function(){var n=sm._sessionContext&&sm._sessionContext.visitor_priority||function(){var n=f.match(/__sm[\._]visitor_priority=(low|high)/i);if(n)return n[1]}()||localStorage.getItem("sm.visitor_priority");return n&&"low"!==n?"priority="+encodeURIComponent(n):""}(),function(){var n=l.site_id;return n?"site_id="+n:""}(),function(){var t=f.match(/__sm[\._]tabId=([^&#]+)/);if(t){n("info","Found tab ID from the page query string");var e=t[1];return sm.tabId=e,"tab_id="+e}}()].filter((function(n){return""!==n})).join("&"),m=a.src.replace(new RegExp("//(assets|cdn|app)\\.([^/]+)/assets/salemove_integration\\.js"),"//api.$2/salemove_integration.js").replace(/salemove_integration\.js.*/,"visitor_config?"+_);Promise.all([function(){var n=sm._sessionContext&&sm._sessionContext.access_token||t()||e();return n?"access_token="+n:""}(),function(){var n=r();return n?"consolidation_token="+n:""}(),function(){var t=window.getGliaContext;if(t&&"function"==typeof t)try{var e=t();if(e)return function(n){return"function"==typeof n.then?s(n):i(n)}(e)}catch(t){n("warn","Unexpected error in getGliaContext()",{error:t})}return[]}()]).then((function(n){var t=n.reduce((function(n,t){return n.concat(t)}),[]).filter((function(n){return""!==n})).join("&"),e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){!function(n){if(delete window.sm.loadDynamic,n.visitor_configuration){sm.conf=n.visitor_configuration,sm.conf.customCodeFile=n.custom_code_file,sm.visitorId=n.visitor_id,sm.accessToken=n.access_token,sm.authenticatedExternally=n.authenticated_externally,sm.visitorConfigUrl=m;var t=document.createElement("script");t.setAttribute("src",sm.conf.assets.server+function(n){var t=sm.conf.assets.s3_prefix;return-1!==sm.conf.assets.server.indexOf("libs.")&&(t="/"),(t||"/")+(sm.conf.assets.hashes&&sm.conf.assets.hashes[n]||n)}("visitor/bootstrapper.js")),t.setAttribute("type","text/javascript"),sm.conf.integrities_enabled&&(t.setAttribute("integrity",function(){for(var n=0;n<sm.conf.integrities.length;n++)if("bootstrapper"===sm.conf.integrities[n].name)return sm.conf.integrities[n].integrity}()),t.setAttribute("crossorigin","*"));var e=!1;t.onload=t.onreadystatechange=function(){e||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e=!0,sm.Bootstrapper.boot(),t.onload=t.onreadystatechange=null)},t.onerror=function(){for(var n=0;n<sm._apiHandlers.length;n++)sm._apiHandlers[n].reject({cause:"network timeout",message:"Failed to load Glia JS API"});t.onerror=null},n.boot_delay_ms>0?setTimeout((function(){document.head.appendChild(t)}),n.boot_delay_ms):document.head.appendChild(t)}}(JSON.parse(e.responseText))}else for(var n=0;n<sm._apiHandlers.length;n++)sm._apiHandlers[n].reject({cause:"network timeout",message:"Failed to fetch site and visitor configuration",response_code:this.status})},e.open("POST",m,!0),e.withCredentials=!0,e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(t)}))}}();